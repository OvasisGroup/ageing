// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id                  String      @id @default(cuid())
  username            String      @unique
  email               String      @unique
  password            String
  role                Role        @default(CUSTOMER)
  subRole             SubRole?
  
  // Common fields
  firstName           String?
  lastName            String?
  phone               String?
  address             String?
  zipCode             String?
  
  // Provider-specific fields
  businessName        String?
  businessAddress     String?
  licenseNumber       String?
  serviceType         ServiceType?
  yearsOfExperience   Int?
  description         String?     @db.Text
  
  // SubRole relationships
  parentUserId        String?
  parentUser          User?       @relation("UserSubRoles", fields: [parentUserId], references: [id], onDelete: Cascade)
  subRoleUsers        User[]      @relation("UserSubRoles")
  
  // SubRole permissions
  permissions         String[]    @default([])
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}

enum Role {
  CUSTOMER
  PROVIDER
  ADMIN
}

enum SubRole {
  FAMILY_MEMBER
  CAREGIVER
}

enum ServiceType {
  HOME_CARE
  MEDICAL_CARE
  COMPANIONSHIP
  HOUSEKEEPING
  TRANSPORTATION
  OTHER
}

model NewsletterSubscription {
  id          String   @id @default(cuid())
  email       String   @unique
  name        String?
  isActive    Boolean  @default(true)
  subscribedAt DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("newsletter_subscriptions")
}

model Inquiry {
  id        String          @id @default(cuid())
  name      String
  email     String
  phone     String
  subject   String
  message   String          @db.Text
  status    InquiryStatus   @default(PENDING)
  priority  InquiryPriority @default(MEDIUM)
  createdAt DateTime        @default(now())
  updatedAt DateTime        @updatedAt

  @@map("inquiries")
}

enum InquiryStatus {
  PENDING
  REVIEWED
  RESPONDED
  CLOSED
}

enum InquiryPriority {
  LOW
  MEDIUM
  HIGH
  URGENT
}

model Category {
  id            String        @id @default(cuid())
  title         String
  description   String?       @db.Text
  image         String?
  slug          String        @unique
  isActive      Boolean       @default(true)
  subcategories Subcategory[]
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt

  @@map("categories")
}

model Subcategory {
  id          String   @id @default(cuid())
  title       String
  description String?  @db.Text
  image       String?
  slug        String   @unique
  isActive    Boolean  @default(true)
  categoryId  String
  category    Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("subcategories")
}
